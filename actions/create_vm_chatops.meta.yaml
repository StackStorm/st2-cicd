---
  name: "create_vm_chatops"
  pack: "st2cd"
  runner_type: "action-chain"
  description: "Create a VM through ChatOps and add DNS"
  enabled: true
  entry_point: "workflows/create_vm_chatops.yaml"
  parameters:
    instance_type:
      type: "string"
      description: "Flavor of to use for instance creation"
      default: "t2.medium"
    environment:
      type: "string"
      description: "Environment to deploy to"
      default: "staging"
      enum:
        - "production"
        - "staging"
        - "sandbox"
    hostname:
      type: "string"
      description: "Short hostname"
      required: true
    os:
      type: "string"
      default: "ubuntu"
      required: true
    author:
      type: "string"
      default: "{{ action_context.api_user }}"
      immutable: true
    dns_zone:
      type: "string"
      description: "Route53 DNS Zone to add host to"
      default: "uswest2.stackstorm.net"
      immutable: true
    purpose:
      type: "string"
      default: "whatever. Ask {{ author }}"
    users:
      type: "string"
      description: "Space-separated list of GitHub usernames"
      default: "manasdk dzimine doriftoshoes lakshmi-kannan m4dcoder enykeev kami emedvedev armab"
    skip_notify:
      default:
        - get_subnet_id
        - get_distro_info
        - get_distro
        - run_instance
        - wait_for_instance
        - wait_for_ssh
        - add_tags
        - add_cname
        - add_keys
        - set_hostname
        - reboot
        - wait_for_ssh_post_reboot
