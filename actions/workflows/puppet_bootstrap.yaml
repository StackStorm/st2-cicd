---
  chain:
    - 
      name: "fetch_puppet_bootstrap_script"
      ref: "st2cd.fetch_puppet_bootstrap"
      params: 
        hosts: "{{hosts}}"
        file: "bootstrap-puppet"
      on-success: "run_puppet_bootstrap"
    - 
      name: "run_puppet_bootstrap"
      ref: "st2cd.run_puppet_bootstrap"
      params: 
        hosts: "{{hosts}}"
      on-success: "run_linux_bootstrap"
    - 
      name: "run_linux_bootstrap"
      ref: "core.remote_sudo"
      params:
        hosts: "{{hosts}}"
        sudo: true
        cmd: "bash /etc/puppet/script/bootstrap-linux"
      on-success: "run_puppet_apply"
    - 
      name: "run_puppet_apply"
      ref: "st2cd.run_puppet_apply"
      params: 
        hosts: "{{hosts}}"
  default: "fetch_puppet_bootstrap_script"
